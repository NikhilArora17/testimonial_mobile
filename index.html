<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
<title>Testimonials Fixed Dots</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300&display=swap" rel="stylesheet">
<style>
  :root{
    /* mobile sizing */
    --frame-w:378px;       /* CHANGED: total block width (centered) */
    --side-margin:0px;     /* CHANGED: no outer side margin; we center the frame */
    --left-inset:42px;     /* CHANGED: inner L/R padding so content = 294px */

    --muted:#B1B5C0; --emph:#454E59;
    --heading-size:24px;

    /* content width = frame - (42 + 42) = 294px */
    --img-w:calc(var(--frame-w) - (var(--left-inset) * 2));
    --img-h:260px;
    --img-to-group-gap:16px;

    --quote-to-text-gap:14px;
    --text-to-meta-gap:40px;

    --dot-w:36px; 
    --dot-h:12px;

    --slide-ms:1000ms;
    --interval-ms:3500ms;

    /* Entrance animation */
    --enter-dur:1.5s;
    --enter-dur-meta:1.8s;   /* meta slower */
    --enter-ease:cubic-bezier(.22,.61,.36,1);
  }

  *{box-sizing:border-box}
  html,body{margin:0;background:#fff;color:#000;font-family:Manrope,system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
  body{display:flex;justify-content:center;}

  .frame{
    width:var(--frame-w);
    margin:0 auto;             /* CHANGED: center the 378px block */
    position:relative;
    overflow:hidden;
  }
  .inner{
    padding-left:var(--left-inset);
    padding-right:var(--left-inset);
  }

  .heading{
    margin:0 0 18px 0;
    font-size:var(--heading-size);
    line-height:1.1;
    font-weight:300;
    letter-spacing:.02em;
    color:var(--muted);
  }
  .heading em{font-style:normal;color:var(--emph);}

  .viewport{
    width:calc(var(--frame-w) - (var(--left-inset) * 2)); /* = 294px */
    overflow:hidden;              /* hides next slide during entrance */
  }
  .track{
    display:flex;
    transition:transform var(--slide-ms) cubic-bezier(.25,.1,.25,1);
    will-change:transform;
  }

  .slide{
    flex:0 0 100%;
    display:flex;
    flex-direction:column;
    align-items:flex-start;
    gap:var(--img-to-group-gap);
  }

  .photo{
    width:var(--img-w);
    height:var(--img-h);
    background:#eee;
    overflow:hidden;
  }
  .photo img{
    width:100%; height:100%;
    object-fit:cover; object-position:50% 18%;
    filter:grayscale(100%);
  }

  .group{
    width:100%;
    display:flex;
    flex-direction:column;
    align-items:flex-start;
  }

  .quoteMark{
    font-weight:300; font-size:32px; line-height:1;
    transform:translateX(-3px);
    margin:0; height:28px; overflow:hidden;
    display:flex; align-items:flex-start;
  }

  .text{
    margin-top:var(--quote-to-text-gap);
    max-width:100%;
    font-weight:300; font-size:12px; line-height:1.6;
  }

  .meta{
    margin-top:var(--text-to-meta-gap);
    font-size:12px; font-weight:300; line-height:1.3; color:#000;
  }
  .meta strong,.meta .role{display:inline;margin:0;padding:0;line-height:1.3;color:#000}

  /* dots row outside the slides so position is ALWAYS fixed */
  .dots{
    width:100%;
    margin-top:24px;
    display:flex; gap:8px; justify-content:flex-start;
  }
  .dot{
    position:relative; width:8px; height:12px; border:0;
    background:#d3d3d3; border-radius:100%;
    cursor:pointer; overflow:hidden;
  }
  .dot.active{
    width:var(--dot-w); height:var(--dot-h);
    border-radius:100px; background:#d3d3d3;
  }
  .dot.active::after{
    content:""; position:absolute; left:0; top:0; bottom:0; width:0%;
    background:#454E59; border-radius:100px;
  }
  .dot.playing::after{ animation: dotfill var(--interval-ms) linear forwards; }
  @keyframes dotfill{ from{width:0%} to{width:100%} }

  /* ===== one-time entrance (FIRST slide only) ===== */
  /* start states added only to first slide + heading */
  .will-enter-left{ opacity:0; transform:translateX(-100%); }
  .enter-left{
    opacity:1; transform:translateX(0);
    transition:transform var(--enter-dur) var(--enter-ease), opacity var(--enter-dur) var(--enter-ease);
  }
  .meta.enter-left{
    transition:transform var(--enter-dur-meta) var(--enter-ease), opacity var(--enter-dur-meta) var(--enter-ease);
  }

  /* photo: REVEAL from bottom via clip-path (no slide) */
  .will-reveal-mask { clip-path: inset(100% 0 0 0); }
  .reveal-mask{
    clip-path: inset(0 0 0 0);
    transition:clip-path var(--enter-dur) var(--enter-ease);
  }

  @media (prefers-reduced-motion:reduce){
    .will-enter-left{opacity:1; transform:none}
    .enter-left{transition:none}
    .will-reveal-mask,.reveal-mask{clip-path:none; transition:none}
    .dot.playing::after{animation:none !important; width:100%}
  }
</style>
</head>
<body>
<div class="frame" id="frame">
  <div class="inner">
    <!-- heading animates from LEFT once -->
    <div class="heading will-enter-left" id="heading">WHAT OUR CLIENTS<br>ARE <em>SAYING</em></div>

    <div class="viewport" id="viewport">
      <div class="track" id="track"></div>
    </div>

    <!-- fixed-position dots row -->
    <div class="dots will-enter-left" id="dots"></div>
  </div>
</div>

<script>
const track = document.getElementById('track');
const dotsContainer = document.getElementById('dots');

const TRANSITION_MS = 1000;
const AUTOPLAY_MS   = 3500;

let idx = 0, timer = null;

const slides = [
  { img: 'public/1.jpg',
    quote: 'Our Elysium Cinema, brought to life by MCBEE within our residence at DLF Camellias, Gurugram, is nothing short of extraordinary. They created an immersive cinematic environment that marries elegance and cutting-edge AV performance.',
    name: 'KP Singh', role: 'Chairman at DLF' },
  { img: 'public/2.jpg',
    quote: 'MCBEE transformed our auditorium with flawless sound, crystal-clear visuals, and seamless controls. Every event now feels world-class.',
    name: 'Satya Nadella', role: 'CEO at Microsoft' },
  { img: 'public/3.jpg',
    quote: 'Working with MCBEE transformed our flagship store into an immersive sensory experience. The lighting, signage screens, and background audio now create a perfect ambiance that reflects our brand story. Shopper engagement has noticeably increased.',
    name: 'Ravi K.', role: 'CEO at INDIA TV' }
];

function build(){
  track.innerHTML = slides.map((s, i)=>`
    <section class="slide ${i===0?'first':''}">
      <div class="photo ${i===0?'will-reveal-mask':''}">
        <img src="${s.img}" alt="${s.name}">
      </div>
      <div class="group">
        <div class="quoteMark ${i===0?'will-enter-left':''}">â€œ</div>
        <div class="text ${i===0?'will-enter-left':''}">${s.quote}</div>
        <div class="meta ${i===0?'will-enter-left':''}">
          <strong>${s.name}</strong><br><span class="role">${s.role}</span>
        </div>
      </div>
    </section>
  `).join('');

  dotsContainer.innerHTML = slides.map((_,k)=>`
    <button class="dot ${k===0?'active':''}" aria-label="Go to slide ${k+1}"></button>
  `).join('');

  dotsContainer.querySelectorAll('.dot').forEach((btn,k)=>{
    btn.addEventListener('click', ()=> go(k,true));
  });

  // show slide 0, but don't start autoplay until entrance finishes
  go(0,false);
  runEntranceOnce();
}

function updateDots(){
  dotsContainer.querySelectorAll('.dot').forEach(d=>{
    d.classList.remove('active','playing');
    d.style.animation = 'none';
  });
  const active = dotsContainer.querySelectorAll('.dot')[idx];
  if(active){
    active.classList.add('active');
    void active.offsetWidth;  // restart fill animation
    active.classList.add('playing');
  }
}

function go(i, user=false){
  idx = (i + slides.length) % slides.length;
  track.style.transform = `translateX(-${idx * 100}%)`;
  updateDots();
  if (user) restart();
}

function next(){ go(idx+1,false); }
function start(){ stop(); timer = setInterval(next, AUTOPLAY_MS); }
function stop(){ if (timer) clearInterval(timer); }
function restart(){ stop(); start(); }

/* One-time entrance: only heading + FIRST slide elements */
function runEntranceOnce(){
  const frame = document.getElementById('frame');
  const heading = document.getElementById('heading');
  const first = track.querySelector('.slide.first');
  const photo = first.querySelector('.photo');
  const quote = first.querySelector('.quoteMark');
  const text  = first.querySelector('.text');
  const meta  = first.querySelector('.meta');
  const dots  = document.getElementById('dots');

  let done = false;

  const io = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if (done) return;
      if (entry.isIntersecting){
        heading.classList.add('enter-left');
        photo.classList.add('reveal-mask');
        [quote,text,meta,dots].forEach(el => el.classList.add('enter-left'));

        [heading,quote,text,meta,dots].forEach(el=> el.classList.remove('will-enter-left'));
        photo.classList.remove('will-reveal-mask');

        done = true;
        io.unobserve(frame);

        const root = getComputedStyle(document.documentElement);
        const durDefault = parseFloat(root.getPropertyValue('--enter-dur'))*1000 || 1500;
        const durMeta    = parseFloat(root.getPropertyValue('--enter-dur-meta'))*1000 || durDefault;
        const wait = Math.max(durDefault, durMeta);

        setTimeout(()=> start(), wait + 50);
      }
    });
  }, {threshold: 0.25});

  io.observe(frame);
}

window.addEventListener('load', build);
</script>
</body>
</html>
